@page "/order"
@using TCH.Data.Entities
@using TCH.WebServer.Models
@using TCH.WebServer.Services.Products
@inject IProductService productServices
<TCH.WebServer.Shared.Header.Header></TCH.WebServer.Shared.Header.Header>
<div class="content d-flex flex-column flex-column-fluid" id="kt_content" data-select2-id="select2-data-kt_content">
						
						<!--begin::Post-->
						<div class="post d-flex flex-column-fluid" id="kt_post" data-select2-id="select2-data-kt_post">
							<!--begin::Container-->
							<div id="kt_content_container" class="container-xxl" data-select2-id="select2-data-kt_content_container">
								<!--begin::Form-->
								<form id="kt_ecommerce_edit_order_form" class="form d-flex flex-column flex-lg-row fv-plugins-bootstrap5 fv-plugins-framework" data-kt-redirect="../../demo1/dist/apps/ecommerce/sales/listing.html" data-select2-id="select2-data-kt_ecommerce_edit_order_form">
									<!--begin::Aside column-->
									<div class="w-100 flex-lg-row-auto w-lg-300px mb-7 me-7 me-lg-10" data-select2-id="select2-data-129-uxyl">
										<!--begin::Order details-->
										<div class="card card-flush py-4">
											<!--begin::Card header-->
											<div class="card-header">
												<div class="card-title">
													<h2>Chi tiết hóa đơn</h2>
												</div>
											</div>
											<!--end::Card header-->
											<!--begin::Card body-->
											<div class="card-body pt-0">
												<div class="d-flex flex-column gap-10" data-select2-id="select2-data-128-smqv">
													<!--begin::Input group-->
													<div class="fv-row">
														<!--begin::Label-->
														<label class="form-label">Order ID</label>
														<!--end::Label-->
														<!--begin::Auto-generated ID-->
														<div class="fw-bolder fs-3">#14564</div>
														<!--end::Input-->
													</div>
													<!--end::Input group-->
													<!--begin::Input group-->
													<div class="fv-row fv-plugins-icon-container" data-select2-id="select2-data-138-wlsr">
														<!--begin::Label-->
														<label class="required form-label">Phương thức thanh toán</label>
														<!--end::Label-->
														<!--begin::Select2-->
														<select class="form-select mb-2 select2-hidden-accessible" data-control="select2" data-hide-search="true" data-placeholder="Select an option" name="payment_method" id="kt_ecommerce_edit_order_payment" data-select2-id="select2-data-kt_ecommerce_edit_order_payment" tabindex="-1" aria-hidden="true">
															<option data-select2-id="select2-data-11-9od2"></option>
															<option value="cod" data-select2-id="select2-data-139-emgi">Trả tiền tại quầy</option>
															<option value="visa" data-select2-id="select2-data-140-twv1">Credit Card (Visa)</option>
														</select>
														<!--end::Select2-->
														<!--begin::Description-->

														<!--end::Description-->
													<div class="fv-plugins-message-container invalid-feedback"></div></div>
													<!--end::Input group-->
													<!--begin::Input group-->
													<div class="fv-row fv-plugins-icon-container" data-select2-id="select2-data-127-spcj">
														<!--begin::Label-->
														<label class="required form-label">Phương thức vận chuyển (Nếu có)</label>
														<!--end::Label-->
														<!--begin::Select2-->
														<select class="form-select mb-2 select2-hidden-accessible" data-control="select2" data-hide-search="true" data-placeholder="Select an option" name="shipping_method" id="kt_ecommerce_edit_order_shipping" data-select2-id="select2-data-kt_ecommerce_edit_order_shipping" tabindex="-1" aria-hidden="true">
															<option data-select2-id="select2-data-13-cpag"></option>
															<option value="none" data-select2-id="select2-data-133-3vcn">N/A - Virtual Product</option>
															<option value="standard" data-select2-id="select2-data-134-xtvn">Standard Rate</option>
															<option value="express" data-select2-id="select2-data-135-uedp">Express Rate</option>
															<option value="speed" data-select2-id="select2-data-136-sf4o">Speed Overnight Rate</option>
														</select>
														<!--end::Select2-->
														<!--begin::Description-->

														<!--end::Description-->
													<div class="fv-plugins-message-container invalid-feedback"></div></div>
													<!--end::Input group-->
													<!--begin::Input group-->
													<div class="fv-row fv-plugins-icon-container">
														<!--begin::Label-->
														<label class="required form-label">Ngày lập hóa đơn</label>
														<!--end::Label-->
														<!--begin::Editor-->
														<input id="kt_ecommerce_edit_order_date" name="order_date" placeholder="Select a date" class="form-control mb-2 flatpickr-input" value="" type="hidden"><input class="form-control mb-2 form-control input" placeholder="Select a date" tabindex="0" type="text" readonly="readonly">
														<!--end::Editor-->
														<!--begin::Description-->

														<!--end::Description-->
													<div class="fv-plugins-message-container invalid-feedback"></div></div>
													<!--end::Input group-->
												</div>
											</div>
											<!--end::Card header-->
										</div>
										<!--end::Order details-->
									</div>
									<!--end::Aside column-->
									<!--begin::Main column-->
									<div class="d-flex flex-column flex-lg-row-fluid gap-7 gap-lg-10">
										<!--begin::Order details-->
										<div class="card card-flush py-4">
											<!--begin::Card header-->
											<div class="card-header">
												<div class="card-title">
													<h2>Thêm sản phẩm</h2>
												</div>
											</div>
											<!--end::Card header-->
											<!--begin::Card body-->
											<div class="card-body pt-0">
												<div class="d-flex flex-column gap-10">
													@if(Product != null)
								{
				<!--begin::Input group-->
														<div>
														<!--begin::Label-->
														<label class="form-label">Thêm sản phẩm vào đơn hàng này</label>
														<!--end::Label-->
														<!--begin::Selected products-->
														<div class="row row-cols-1 row-cols-xl-3 row-cols-md-2 border border-dashed rounded pt-3 pb-1 px-2 mb-5 mh-300px overflow-scroll" id="kt_ecommerce_edit_order_selected_products">
															<!--begin::Empty message-->
															<span class="w-100 text-muted d-none">Select one or more products from the list below by ticking the checkbox.</span>
															<!--end::Empty message-->
														<div class="col my-2" data-kt-ecommerce-edit-order-filter="product" data-kt-ecommerce-edit-order-id="product_15"><div class="d-flex align-items-center border border-dashed rounded p-3 bg-white">
																		<!--begin::Thumbnail-->
																		<a href="../../demo1/dist/apps/ecommerce/catalog/edit-product.html" class="symbol symbol-50px">
																			<span class="symbol-label" style="background-image:url(@Product.LinkImage);"></span>
																		</a>
																		<!--end::Thumbnail-->
																		<div class="ms-5">
																			<!--begin::Title-->
																			<a href="../../demo1/dist/apps/ecommerce/catalog/edit-product.html" class="text-gray-800 text-hover-primary fs-5 fw-bolder">@Product.Name</a>
																			<!--end::Title-->
																			<!--begin::Price-->
																			<div class="fw-bold fs-7 text-primary">Price: 
																			<span data-kt-ecommerce-edit-order-filter="price">@Product.Price</span></div>
																			<!--end::Price-->
																			<!--begin::SKU-->
																			<div class="text-muted fs-7">SKU: 04933003</div>
																			<!--end::SKU-->
																		</div>
																	</div>
																	</div>
																	</div>
														<!--begin::Selected products-->
														<!--begin::Total price-->
														<div class="fw-bolder fs-4 text-primary">Tổng: 
														<span id="kt_ecommerce_edit_order_total_price">@Product.Price </span></div>
														<!--end::Total price-->
													</div>
													<!--end::Input group-->
									<!--begin::Input group-->
								}
													<!--begin::Separator-->
													<div class="separator"></div>
													<!--end::Separator-->
													<!--begin::Search products-->
													<div class="d-flex align-items-center position-relative mb-n7">
														<!--begin::Svg Icon | path: icons/duotune/general/gen021.svg-->
														<span class="svg-icon svg-icon-1 position-absolute ms-4">
															<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
																<rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1" transform="rotate(45 17.0365 15.1223)" fill="black"></rect>
																<path d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z" fill="black"></path>
															</svg>
														</span>
														<!--end::Svg Icon-->
														<input type="text" data-kt-ecommerce-edit-order-filter="search" class="form-control form-control-solid w-100 w-lg-50 ps-14" placeholder="Tìm kiếm sản phẩm">
													</div>
													<!--end::Search products-->
													<!--begin::Table-->
													<div id="kt_ecommerce_edit_order_product_table_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer"><div class="table-responsive"><div class="dataTables_scroll"><div class="dataTables_scrollHead" style="overflow: hidden; position: relative; border: 0px; width: 100%;"><div class="dataTables_scrollHeadInner" style="box-sizing: content-box; width: 628px; padding-right: 5px;"><table class="table align-middle table-row-dashed fs-6 gy-5 dataTable no-footer" style="margin-left: 0px; width: 628px;"><thead>
															<tr class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0"><th class="w-25px pe-2 sorting_disabled" rowspan="1" colspan="1" style="width: 24.9844px;" aria-label=""></th><th class="min-w-200px sorting" tabindex="0" aria-controls="kt_ecommerce_edit_order_product_table" rowspan="1" colspan="1" style="width: 362.938px;" aria-label="Product: activate to sort column ascending">Product</th><th class="min-w-100px text-end pe-5 sorting" tabindex="0" aria-controls="kt_ecommerce_edit_order_product_table" rowspan="1" colspan="1" style="width: 197.828px;" aria-label="Qty Remaining: activate to sort column ascending"></th></tr>
														</thead></table></div></div><div class="dataTables_scrollBody" style="position: relative; overflow: auto; max-height: 400px; width: 100%;"><table class="table align-middle table-row-dashed fs-6 gy-5 dataTable no-footer" id="kt_ecommerce_edit_order_product_table" style="width: 100%;"><thead>
															<tr class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0" style="height: 1px;"><th class="w-25px pe-2 sorting_disabled" rowspan="1" colspan="1" style="width: 24.9844px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"><div class="dataTables_sizing" style="height: 0px; overflow: hidden;"></div></th><th class="min-w-200px sorting" aria-controls="kt_ecommerce_edit_order_product_table" rowspan="1" colspan="1" style="width: 362.938px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"><div class="dataTables_sizing" style="height: 0px; overflow: hidden;">Product</div></th><th class="min-w-100px text-end pe-5 sorting" aria-controls="kt_ecommerce_edit_order_product_table" rowspan="1" colspan="1" style="width: 197.828px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;"><div class="dataTables_sizing" style="height: 0px; overflow: hidden;">Qty Remaining</div></th></tr>
														</thead>
														<!--begin::Table head-->
														
														<!--end::Table head-->
														<!--begin::Table body-->
														<tbody class="fw-bold text-gray-600">
															
														@if(ProductsList != null){
															foreach(var product in ProductsList){
																<tr class="odd">
																<!--begin::Checkbox-->
																	<td>
																		<div class="form-check form-check-sm form-check-custom form-check-solid">
																			<input class="form-check-input" type="checkbox" value="1">
																		</div>
																	</td>
																	<!--end::Checkbox-->
																	<!--begin::Product=-->
																	<td>
																		<div class="d-flex align-items-center" data-kt-ecommerce-edit-order-filter="product" data-kt-ecommerce-edit-order-id="product_1">
																			<!--begin::Thumbnail-->
																			<a href="../../demo1/dist/apps/ecommerce/catalog/edit-product.html" class="symbol symbol-50px">
																				<span class="symbol-label" style="background-image:url(@product.LinkImage);"></span>
																			</a>
																			<!--end::Thumbnail-->
																			<div class="ms-5">
																				<!--begin::Title-->
																				<a href="../../demo1/dist/apps/ecommerce/catalog/edit-product.html" class="text-gray-800 text-hover-primary fs-5 fw-bolder">@product.Name</a>
																				<!--end::Title-->
																				<!--begin::Price-->
																				<div class="fw-bold fs-7">Price: $
																				<span data-kt-ecommerce-edit-order-filter="price">@product.Price</span></div>
																				<!--end::Price-->
																				<!--begin::SKU-->
																				<div class="text-muted fs-7">SKU: 02639002</div>
																				<!--end::SKU-->
																			</div>
																		</div>
																	</td>
																	<!--end::Product=-->
																	<!--begin::Qty=-->
																	<td class="text-end pe-5" data-order="31">
																		<span class="fw-bolder ms-3">31</span>
																	</td>
																	<!--end::Qty=-->
																</tr>
															}
														}
															</tbody>
														<!--end::Table body-->
													</table></div></div></div><div class="row"><div class="col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"></div><div class="col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"></div></div></div>
													<!--end::Table-->
												</div>
											</div>
											<!--end::Card header-->
										</div>
										<!--end::Order details-->
										
										<div class="d-flex justify-content-end">
											<!--begin::Button-->
											<a href="../../demo1/dist/apps/ecommerce/catalog/products.html" id="kt_ecommerce_edit_order_cancel" class="btn btn-light me-5">Cancel</a>
											<!--end::Button-->
											<!--begin::Button-->
											<button type="submit" id="kt_ecommerce_edit_order_submit" class="btn btn-primary">
												<span class="indicator-label">Save Changes</span>
												<span class="indicator-progress">Please wait...
												<span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
											</button>
											<!--end::Button-->
										</div>
									</div>
									<!--end::Main column-->
								<div></div></form>
								<!--end::Form-->
							</div>
							<!--end::Container-->
						</div>
						<!--end::Post-->
					</div>

@code{
	public List<Product>? ProductsList = new List<Product>();
	public Product? Product = new Product();
	public string Name;
	private int pageSize = 10;
	private int PageNumber = 1;
	private int totalPage;
	protected override async  Task OnParametersSetAsync()
	{
		await Get();
		base.OnParametersSet();
	}
	public async Task Get(){
		var response = await productServices.GetProducts( true,  pageSize,  PageNumber);
        PageNumber = response.Data.CurrentPage;
        ProductsList = response.Data.Items.ToList();
        totalPage = response.Data.TotalPages;
		Product = ProductsList[0];
	}
}}